knitr::opts_chunk$set(echo = TRUE)
#library(leaflet)
library(knitr)
library(tidyverse)
library(haven)
library(kableExtra)
library(formattable)
library(htmltools)
#library(webshot) # Desnecessário
#library(gm)
library(kableExtra)
library(ggrepel)
library(lubridate)
library(GGally)
library(mosaicData)
library(paletteer)
library(tidymodels)
library(fastDummies)
library("rmdshower")
plot(cars)
library(tidyverse)
database <- read_csv("https://github.com/carlos-itpro/Projeto-Analytics-Descritiva/raw/main/database_full.csv",
show_col_types = FALSE)
str(database)
varzea <- readr::read_csv("varzea.csv", show_col_types = FALSE)
frequentes <- database %>%
group_by(nome_bairro,desc_atividade,nome_grupo) %>%
count(sort = TRUE)
varzea <- frequentes %>%
filter(nome_bairro == "VARZEA")
write_csv(varzea,"varzea.csv")
varzea <- readr::read_csv("varzea.csv", show_col_types = FALSE)
knitr::kable(head(varzea,5),digits = 1,col.names = c("Bairro","Atividade","Grupo","Qtde"))
varzea <- readr::read_csv("varzea.csv", show_col_types = FALSE)
knitr::kable(head(varzea,5),digits = 1,col.names = c("Bairro","Atividade","Grupo","Qtde"))
library(tidyverse)
incomodos <- readr::read_csv("incomodos.csv", show_col_types = FALSE)
library(tidyverse)
incomodos <- readr::read_csv("incomodos.csv", show_col_types = FALSE)
incomodos <- database %>%
filter(incomodo == "S") %>%
group_by(nome_bairro) %>%
count(sort = TRUE)
write_csv(incomodos,"incomodos.csv")
library(tidyverse)
incomodos <- readr::read_csv("incomodos.csv", show_col_types = FALSE)
incomodos_fac <- incomodos                                                 # Replicate original data
incomodos_fac$nome_bairro <- factor(incomodos_fac$nome_bairro,             # Factor levels in decreasing order
levels = incomodos_fac$nome_bairro[order(incomodos_fac$n, decreasing = FALSE)])
mynamestheme <- theme(plot.title = element_text(family = "Fira Code", face = "bold", size = (12)),
legend.title = element_text(colour = "steelblue",  face = "bold.italic", family = "Fira Code"),
legend.text = element_text(face = "italic", colour="steelblue4",family = "Fira Code"),
axis.title = element_text(family = "Fira Code", size = (10), colour = "steelblue4", face = "bold"),
axis.text = element_text(family = "Fira Code", face = "italic", colour = "steelblue4", size = (10)))
ggplot(head(incomodos_fac,10)) +
geom_col( aes (x = n, y = nome_bairro, fill = n), show.legend = TRUE) +
xlab("Empresas causadoras de incômodo") +
ylab("Bairros") +
guides(fill=guide_legend(title="Qtde")) +
ggtitle("Bairros com Maior Incômodo Potêncial") + mynamestheme
ggplot(tail(incomodos_fac,10)) +
geom_col( aes (x = n, y = nome_bairro, fill = n), show.legend = TRUE) +
xlab("Empresas causadoras de incômodo") +
ylab("Bairros") +
guides(fill=guide_legend(title="Qtde")) +
ggtitle("Bairros com Menor Incômodo Potêncial") + mynamestheme
library(tidyverse)
incomodos <- readr::read_csv("incomodos.csv", show_col_types = FALSE)
incomodos_fac <- incomodos                                                 # Replicate original data
incomodos_fac$nome_bairro <- factor(incomodos_fac$nome_bairro,             # Factor levels in decreasing order
levels = incomodos_fac$nome_bairro[order(incomodos_fac$n, decreasing = FALSE)])
mynamestheme <- theme(plot.title = element_text(family = "Fira Code", face = "bold", size = (12)),
legend.title = element_text(colour = "steelblue",  face = "bold.italic", family = "Fira Code"),
legend.text = element_text(face = "italic", colour="steelblue4",family = "Fira Code"),
axis.title = element_text(family = "Fira Code", size = (10), colour = "steelblue4", face = "bold"),
axis.text = element_text(family = "Fira Code", face = "italic", colour = "steelblue4", size = (10)))
ggplot(head(incomodos_fac,10)) +
geom_col( aes (x = n, y = nome_bairro, fill = n), show.legend = TRUE) +
xlab("Empresas causadoras de incômodo") +
ylab("Bairros") +
guides(fill=guide_legend(title="Qtde")) +
ggtitle("Bairros com Maior Incômodo Potêncial") + mynamestheme
ggplot(tail(incomodos_fac,10)) +
geom_col( aes (x = n, y = nome_bairro, fill = n), show.legend = TRUE) +
xlab("Empresas causadoras de incômodo") +
ylab("Bairros") +
guides(fill=guide_legend(title="Qtde")) +
ggtitle("Bairros com Menor Incômodo Potêncial") + mynamestheme
library(tidyverse)
database <- read_csv("https://github.com/carlos-itpro/Projeto-Analytics-Descritiva/raw/main/database_limpa.csv",
show_col_types = FALSE)
frequentes_2 <- database %>%
group_by(nome_bairro,nome_grupo,desc_atividade,total) %>%
count(sort = TRUE)
frequentes_3 <- database %>%
group_by(nome_bairro,nome_grupo,desc_atividade,mulheres) %>%
count(sort = TRUE)
fitness <- frequentes_2 %>%
filter(desc_atividade == "ATIVIDADES DE CONDICIONAMENTO FÍSICO")
fitness <- fitness %>%
mutate(proporcao = total/n)  %>%
arrange(proporcao)
educacao <- frequentes_2 %>%
filter(desc_atividade == "EDUCAÇÃO INFANTIL - PRÉ-ESCOLA")
educacao <- educacao %>%
mutate(proporcao = total/n)  %>%
arrange(proporcao)
lazer <- frequentes_2 %>%
filter(desc_atividade == "PRODUÇÃO MUSICAL")
lazer <- lazer %>%
mutate(proporcao = total/n)  %>%
arrange(proporcao)
estetica <- frequentes_3 %>%
filter(desc_atividade == "CABELEIREIROS, MANICURE E PEDICURE")
estetica <- estetica %>%
mutate(proporcao = mulheres/n)  %>%
arrange(proporcao)
write_csv(fitness,"fitness.csv")
write_csv(educacao,"educacao.csv")
write_csv(lazer,"lazer.csv")
write_csv(estetica,"estetica.csv")
fitness <- readr::read_csv("fitness.csv", show_col_types = FALSE)
knitr::kable(head(fitness,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Habitantes"
,"Qtde","Proporção de Habitantes"))
knitr::kable(tail(fitness,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Habitantes"
,"Qtde","Proporção de Habitantes"))
library(tidyverse)
fitness <- readr::read_csv("fitness.csv", show_col_types = FALSE)
fitness_fac <- fitness                                                 # Replicate original data
fitness_fac$nome_bairro <- factor(fitness_fac$nome_bairro,             # Factor levels in decreasing order
levels = fitness_fac$nome_bairro[order(fitness_fac$proporcao, decreasing = TRUE)])
ggplot(head(fitness_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Maior Oferta de Academias") + mynamestheme
ggplot(tail(fitness_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Menor Oferta de Academias") + mynamestheme
educacao <- readr::read_csv("educacao.csv", show_col_types = FALSE)
knitr::kable(head(educacao,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Habitantes"
,"Qtde","Proporção de Habitantes"))
knitr::kable(tail(educacao,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Habitantes"
,"Qtde","Proporção de Habitantes"))
library(tidyverse)
educacao <- readr::read_csv("educacao.csv", show_col_types = FALSE)
educacao_fac <- educacao                                                 # Replicate original data
educacao_fac$nome_bairro <- factor(educacao_fac$nome_bairro,             # Factor levels in decreasing order
levels = educacao_fac$nome_bairro[order(educacao_fac$proporcao, decreasing = TRUE)])
ggplot(head(educacao_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Maior Oferta de Educação Infatil") + mynamestheme
ggplot(tail(educacao_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Menor Oferta de Educação Infatil") + mynamestheme
lazer <- readr::read_csv("lazer.csv", show_col_types = FALSE)
knitr::kable(head(lazer,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Habitantes"
,"Qtde","Proporção de Habitantes"))
knitr::kable(tail(lazer,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Habitantes"
,"Qtde","Proporção de Habitantes"))
library(tidyverse)
lazer <- readr::read_csv("lazer.csv", show_col_types = FALSE)
lazer_fac <- lazer                                                 # Replicate original data
lazer_fac$nome_bairro <- factor(lazer_fac$nome_bairro,             # Factor levels in decreasing order
levels = lazer_fac$nome_bairro[order(lazer_fac$proporcao, decreasing = TRUE)])
ggplot(head(lazer_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Maior Oferta de Produções Musicais") + mynamestheme
ggplot(tail(lazer_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Menor Oferta de Produções Musicais") + mynamestheme
estetica <- readr::read_csv("estetica.csv", show_col_types = FALSE)
knitr::kable(head(estetica,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Mulheres"
,"Qtde","Proporção de Mulheres"))
knitr::kable(tail(estetica,5),digits = 1,col.names = c("Bairro","Ramo","Atividade","Total Mulheres"
,"Qtde","Proporção de Mulheres"))
library(tidyverse)
estetica <- readr::read_csv("estetica.csv", show_col_types = FALSE)
estetica_fac <- estetica                                                 # Replicate original data
estetica_fac$nome_bairro <- factor(estetica_fac$nome_bairro,             # Factor levels in decreasing order
levels = estetica_fac$nome_bairro[order(estetica_fac$proporcao, decreasing = TRUE)])
ggplot(head(estetica_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes do Sexo Feminino por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Maior Oferta de Serviços de Estética") + mynamestheme
ggplot(tail(estetica_fac,5)) +
geom_col( aes (x = proporcao, y = nome_bairro, fill = proporcao), show.legend = TRUE) +
xlab("Habitantes do Sexo Feminino por empresa") +
ylab("Bairros") +
guides(fill=guide_legend(title="Proporção")) +
ggtitle("Bairros com Menor Oferta de Serviços de Estética") + mynamestheme
